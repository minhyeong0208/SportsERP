<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>선수 관리 - Football Team ERP</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
    <!-- Admin CSS -->
    <link rel="stylesheet" href="/admin/css/admin.css">
    <!-- Vue.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/vue@3/dist/vue.global.js"></script>
    <style>
        .table-responsive {
            margin-top: 20px;
        }

        .btn-space {
            margin-right: 10px;
        }
    </style>
</head>

<body>
    <div id="app">
        <admin-header></admin-header>
        <admin-sidebar></admin-sidebar>

        <!-- Content -->
        <div id="content" class="container mt-5">
            <h2>선수 관리</h2>

            <!-- 선수 추가 버튼과 검색 필드 -->
            <div class="d-flex justify-content-between mb-4">
                <button class="btn btn-success btn-space" @click="openAddPlayerModal">선수 추가</button>
                <input type="text" v-model="searchQuery" placeholder="선수 이름 검색" class="form-control w-50">
            </div>

            <!-- 선수 목록 테이블 -->
            <div class="table-responsive">
                <table v-if="players.length > 0" class="table table-bordered table-hover table-striped align-middle">
                    <thead class="table-dark">
                        <tr>
                            <th scope="col">사진</th>
                            <th scope="col">등번호</th>
                            <th scope="col">이름</th>
                            <th scope="col">포지션</th>
                            <th scope="col">국적</th>
                            <th scope="col">잠재력</th>
                            <th scope="col">생일</th>
                            <th scope="col">계약 시작일</th>
                            <th scope="col">계약 종료일</th>
                            <th scope="col">경력</th>
                            <th scope="col">관리</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr v-for="(player, index) in filteredPlayers" :key="index">
                            <td><img :src="player.playerImage" :alt="player.playerName" class="img-thumbnail" style="width: 50px; height: 50px;"></td>
                            <td>{{ player.playerBn }}</td>
                            <td>{{ player.playerName }}</td>
                            <td>{{ player.playerPosition }}</td>
                            <td>{{ player.playerNationality }}</td>
                            <td>{{ player.playerPotential }}</td>
                            <td>{{ player.playerBirth }}</td>
                            <td>{{ player.contractStartDate }}</td>
                            <td>{{ player.contractEndDate }}</td>
                            <td>{{ player.career }}</td>
                            <td>
                                <button class="btn btn-primary btn-sm" @click="editPlayer(player)">수정</button>
                                <button class="btn btn-danger btn-sm" @click="deletePlayer(player.playerId)">삭제</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- 페이지 네비게이션 -->
            <nav v-if="totalPages > 1" class="mt-4">
                <ul class="pagination justify-content-center">
                    <li class="page-item" :class="{ disabled: pageNumber === 0 }">
                        <button class="page-link" @click="changePage(pageNumber - 1)" :disabled="pageNumber === 0">이전</button>
                    </li>
                    <li v-for="page in pagesToShow" :key="page" :class="{ active: pageNumber === page }" class="page-item">
                        <button class="page-link" @click="changePage(page)">{{ page + 1 }}</button>
                    </li>
                    <li class="page-item" :class="{ disabled: pageNumber === totalPages - 1 }">
                        <button class="page-link" @click="changePage(pageNumber + 1)" :disabled="pageNumber === totalPages - 1">다음</button>
                    </li>
                </ul>
            </nav>
        </div>

        <!-- 선수 추가/수정 모달 -->
        <div class="modal fade" id="playerModal" tabindex="-1" aria-labelledby="playerModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="playerModalLabel">{{ editingPlayerId ? '선수 수정' : '선수 추가' }}</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <form @submit.prevent="savePlayer">
                            <div class="mb-3">
                                <label for="playerImage" class="form-label">사진</label>
                                <input type="file" class="form-control" id="playerImage" ref="playerImage">
                            </div>
                            <div class="mb-3">
                                <label for="playerBn" class="form-label">등번호</label>
                                <input type="number" class="form-control" id="playerBn" v-model="playerForm.playerBn" required>
                            </div>
                            <div class="mb-3">
                                <label for="playerName" class="form-label">이름</label>
                                <input type="text" class="form-control" id="playerName" v-model="playerForm.playerName" required>
                            </div>
                            <div class="mb-3">
                                <label for="playerPosition" class="form-label">포지션</label>
                                <input type="text" class="form-control" id="playerPosition" v-model="playerForm.playerPosition" required>
                            </div>
                            <div class="mb-3">
                                <label for="playerNationality" class="form-label">국적</label>
                                <input type="text" class="form-control" id="playerNationality" v-model="playerForm.playerNationality" required>
                            </div>
                            <div class="mb-3">
                                <label for="playerPotential" class="form-label">잠재력</label>
                                <input type="number" class="form-control" id="playerPotential" v-model="playerForm.playerPotential" required>
                            </div>
                            <div class="mb-3">
                                <label for="playerBirth" class="form-label">생일</label>
                                <input type="date" class="form-control" id="playerBirth" v-model="playerForm.playerBirth" required>
                            </div>
                            <div class="mb-3">
                                <label for="contractStartDate" class="form-label">계약 시작일</label>
                                <input type="date" class="form-control" id="contractStartDate" v-model="playerForm.contractStartDate" required>
                            </div>
                            <div class="mb-3">
                                <label for="contractEndDate" class="form-label">계약 종료일</label>
                                <input type="date" class="form-control" id="contractEndDate" v-model="playerForm.contractEndDate" required>
                            </div>
                            <div class="mb-3">
                                <label for="career" class="form-label">경력</label>
                                <textarea class="form-control" id="career" v-model="playerForm.career" required></textarea>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">취소</button>
                                <button type="submit" class="btn btn-primary">저장</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 외부 컴포넌트 파일 -->
    <script src="/admin/js/admin-header.js"></script>
    <script src="/admin/js/admin-sidebar.js"></script>
    <script src="/admin/js/player.js"></script>
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>
